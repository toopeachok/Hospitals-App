!function(t){var e={};function n(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(o,a,function(e){return t[e]}.bind(null,a));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);n(0),n(1);const o={};function a(t){if("delete"===t.target.dataset.btnType&&function(t){const e="#card-"+t.target.dataset.cardId,n=document.querySelector(e);n.classList.add("hide-hospital-card"),setTimeout(()=>{!function(t){let e=JSON.parse(localStorage.getItem("hospitals"));e[parseInt(t)]={},localStorage.setItem("hospitals",JSON.stringify(e))}(""+t.target.dataset.cardId),n.querySelector(".card-buttons").removeEventListener("click",a),n.remove()},500)}(t),"edit"===t.target.dataset.btnType){const e=parseInt(t.target.dataset.cardId),n=document.querySelector("#card-"+e),a=n.querySelector(".hospital-name").textContent,r=n.querySelector(".hospital-address").textContent,s=n.querySelector(".hospital-phone-link").textContent;o.editCardModal({title:"Редактировать",content:`\n        <form name="edit-card-form" id="edit-card-form">\n          <div class="form-group">\n            <label for="hospital-name-input">\n              Название\n            </label>\n            <input class="form-control"\n            name="hospital-name-input"\n            type="text"\n            value="${a}"\n            required\n            >\n          </div>\n          <div class="form-group">\n            <label for="hospital-address-input">\n              Адрес\n            </label>\n            <input class="form-control"\n            name="hospital-address-input"\n            type="text"\n            value="${r}"\n            required\n            >\n          </div>\n          <div class="form-group">\n            <label for="hospital-phone-input">\n              Телефон\n            </label>\n            <input class="form-control"\n            name="hospital-phone-input"\n            type="text"\n            value="${s}"\n            required\n            >\n          </div>\n        </form>\n      `,formSubmitButtonOptions:["submit","edit-card-form"]}).then(()=>{const t=document.forms["edit-card-form"],o=t["hospital-name-input"].value,a=t["hospital-address-input"].value,r=t["hospital-phone-input"].value;n.querySelector(".hospital-name").textContent=o,n.querySelector(".hospital-address").textContent=a,n.querySelector(".hospital-phone-link").textContent=r,function(t,e,n,o){let a=JSON.parse(localStorage.getItem("hospitals"));a[parseInt(t)].full_name=e,a[parseInt(t)].address=n,a[parseInt(t)].phone=o,localStorage.setItem("hospitals",JSON.stringify(a))}(e,o,a,r)})}}function r(){o.editCardModal({title:"Создать",content:'\n        <form name="create-card-form" id="create-card-form">\n          <div class="form-group">\n            <label for="hospital-name-input">\n              Название\n            </label>\n            <input class="form-control"\n            name="hospital-name-input"\n            type="text"\n            required\n            >\n          </div>\n          <div class="form-group">\n            <label for="hospital-address-input">\n              Адрес\n            </label>\n            <input class="form-control"\n            name="hospital-address-input"\n            type="text"\n            required\n            >\n          </div>\n          <div class="form-group">\n            <label for="hospital-phone-input">\n              Телефон\n            </label>\n            <input class="form-control"\n            name="hospital-phone-input"\n            type="text"\n            required\n            >\n          </div>\n        </form>\n      ',formSubmitButtonOptions:["submit","create-card-form"]}).then(()=>{const t=document.forms["create-card-form"],e=t["hospital-name-input"].value,n=t["hospital-address-input"].value,o=t["hospital-phone-input"].value;let r=JSON.parse(localStorage.getItem("hospitals"));r.push({full_name:""+e,address:""+n,phone:""+o}),localStorage.setItem("hospitals",JSON.stringify(r)),document.querySelector(".hospitals").remove(),document.querySelectorAll(".card-buttons").forEach(t=>{t.removeEventListener("click",a)}),s(r)})}function s(t){const e=document.createElement("div");e.classList.add("hospitals");for(let n=0;n<t.length;n++)Object.keys(t[n]).length&&(e.innerHTML+=l(t[n],n));document.querySelector(".container").insertAdjacentElement("afterbegin",e),e.querySelectorAll(".card-buttons").forEach(t=>{t.addEventListener("click",t=>a(t))})}function l(t,e){return`\n  \n  <div class="hospital-card card" id="card-${e}">\n    <h5 class="hospital-name card-title">${t.full_name}</h5>\n    <div class="hospital-address">${t.address}</div>\n    <div class="hospital-phone">\n      <a class="hospital-phone-link" href="tel:${t.phone}">${t.phone}</a>\n    </div>\n    <div class="card-buttons">\n      <button class="btn btn-outline-danger hospital-button" data-btn-type="delete" data-card-id="${e}">удалить</button>\n      <button class="btn btn-outline-primary hospital-button" data-btn-type="edit" data-card-id="${e}">редактировать</button>\n    </div>\n  </div>\n  \n  `}function i(t){localStorage.setItem("hospitals",JSON.stringify(t))}o.modal=function(t){function e(){}let n=!1,o=!1;const a={open(){if(o)return console.log("Modal is destroyed");!n&&s.classList.add("open")},close(){n=!0,s.classList.remove("open"),s.classList.add("hide"),setTimeout(()=>{s.classList.remove("hide"),n=!1,"function"==typeof t.onClose&&t.onClose()},200)}},r=t=>{t.target.dataset.close&&a.close()},s=function(t){const n=document.createElement("div");n.classList.add("vmodal");let o=`\n      <div class="modal-overlay" data-close="true">\n    \n        <div class="modal-window" style="width: ${t.width||"300px"}">\n    \n          <div class="modal-header">\n    \n            <span class="modal-title"> ${t.title||"Default title"} </span>\n    \n            ${t.closable?'<span class="modal-close" data-close="true">&times</span>':""}\n    \n          </div>\n    \n          <div class="modal-body" data-content>\n          \n            ${t.content||""}\n    \n          </div>\n    \n        </div>\n    \n      </div>\n    `;n.insertAdjacentHTML("afterbegin",o);const a=function(t=[]){if(0===t.length)return document.createElement("div");const n=document.createElement("div");return n.classList.add("modal-footer"),t.forEach(t=>{const o=document.createElement("button");o.textContent=t.text,o.classList.add("btn"),o.classList.add("btn-"+(t.class||"secondary")),o.onclick=t.handler||e,t.type&&o.setAttribute("type",""+t.type),t.for&&o.setAttribute("for",""+t.for),n.append(o)}),n}(t.footerButtons);return n.querySelector(".modal-window").append(a),document.body.append(n),n}(t);return s.addEventListener("click",r),Object.assign(a,{destroy(){s.parentNode.removeChild(s),s.removeEventListener("click",r),o=!0},setContent(t){s.querySelector("[data-content]").innerHTML=t},setTitle(t){s.querySelector(".modal-title").innerHTML=t}})},o.editCardModal=function(t){return new Promise((e,n)=>{const a=o.modal({title:t.title,width:"300px",closable:!1,content:t.content,onClose(){a.destroy()},footerButtons:[{text:"Сохранить",class:"success",type:t.formSubmitButtonOptions[0],for:t.formSubmitButtonOptions[1],handler(){e(),a.close()}},{text:"Отменить",class:"secondary",handler(){a.close()}}]});setTimeout(()=>{a.open()},0)})};const d=document.querySelector("#get-data-from-server-btn");d.addEventListener("click",()=>{(function(t){return new Promise((e,n)=>{const o=new XMLHttpRequest;o.open("GET",t),o.onload=()=>{o.status>=400?n(o.response):e(o.response)},o.onerror=()=>{n(o.response)},o.send()})})("./data/lpu.json").then(t=>JSON.parse(t)).then(i).then(()=>JSON.parse(localStorage.getItem("hospitals"))).then(s).then(()=>{const t=document.querySelector("#add-hospital-btn");t.addEventListener("click",r),t.style.display="block",d.style.display="none"}).catch(t=>console.log(t))})}]);